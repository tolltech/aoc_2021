using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Reflection.Metadata;
using FluentAssertions;
using NUnit.Framework;

namespace AoC_2021
{
    [TestFixture]
    public class Task25
    {
        private static int maxX;
        private static int maxY;

        [Test]
        [TestCaseSource(nameof(GenerateTestCases))]
        public void Solve(string input, int expected)
        {
            var lines = input.Split("\r\n", StringSplitOptions.RemoveEmptyEntries);

            var map = lines.Select(x => x.ToCharArray()).ToArray();

            var cucumbers = map
                .SelectMany((chars, y) => chars.Select((c, x) => (Point: (y, x), Char: c)))
                .Where(x => x.Char != '.').ToArray();

            maxX = map.First().Length - 1;
            maxY = map.Length - 1;

            var rights = cucumbers.Where(x => x.Char == '>').Select(x => x.Point).ToHashSet();
            var downs = cucumbers.Where(x => x.Char == 'v').Select(x => x.Point).ToHashSet();

            var stepCount = 0;
            while (true)
            {
                var wasMove = false;

                var newRights = rights.ToHashSet();
                foreach (var right in rights)
                {
                    var next = GetEmptyRight(right, rights, downs);
                    if (next == null) continue;

                    wasMove = true;
                    newRights.Remove(right);
                    newRights.Add(next.Value);
                }

                rights = newRights;

                var newDowns = downs.ToHashSet();
                foreach (var down in downs)
                {
                    var next = GetEmptyDown(down, rights, downs);
                    if (next == null) continue;

                    wasMove = true;
                    newDowns.Remove(down);
                    newDowns.Add(next.Value);
                }

                downs = newDowns;
                
                ++stepCount;
                
                if (!wasMove) break;
            }

            stepCount.Should().Be(expected);
        }

        private static (int Y, int X)? GetEmptyRight((int Y, int X) point, params HashSet<(int Y, int X)>[] herds)
        {
            var next = (point.Y, point.X == maxX ? 0 : point.X + 1);
            if (herds.Any(x => x.Contains(next))) return null;
            return next;
        }
        
        private static (int Y, int X)? GetEmptyDown((int Y, int X) point, params HashSet<(int Y, int X)>[] herds)
        {
            var next = (point.Y == maxY ? 0 : point.Y + 1, point.X);
            if (herds.Any(x => x.Contains(next))) return null;
            return next;
        }

        private static IEnumerable<TestCaseData> GenerateTestCases()
        {
            yield return new TestCaseData(@"v...>>.vv>
.vv>>.vv..
>>.>v>...v
>>v>>.>.v.
v>v.vv.v..
>.>>..v...
.vv..>.>v.
v.v..>>v.v
....v..v.>", 58);
            yield return new TestCaseData(
                @"....v>>.>>v>....>>v....>..vv.>..v.>.v>v.v..v>vv.>>>...>v..v....vv.v>.>v.>..v...vv>v.>v>>vvv...>>>vvvvv>.>>>vv....v>>>vv.>.>>>..v>>v>>.>>..>
.vv>.>.>....v....>v>>vvv....>>v....vv...>..>..v...>.>.vv.....v..v.>.>..v.>v>>..>v.....>.....>>.v>v.......v...>v.vv.v>........>.....>..>..v.
vvv..>>...v>v.>>.>......v.>>v...vv..>...>v>.....vv..v..........vv>vv..>>v.>v>...>.v>..v.>>v.v......v.v..v>v.v.v.....v>>..>v>vvv......v>...v
..>>>vv...v>.v>.>v>.vvv>..>.>.v>.>.v.vv>v.v.>v>...>vvvv....v.vv>.v..>v>.vv.v..v>.vv>>>..v..v>.>.>>...vvv>v>.>.v>..>>...v....v>.>...vv.v.v.v
>.>..>v.v..>>.v>>..v...v>..>.>.v.>v.>.....>.........>>v.v..>.>>vv.>>...v>v...v.>v..v>.v>.v..v>>.v.>vvv...v.>v>...>v.vvv>v..>>.>v..>...>v>.v
.v.>v...v..>.v.>.>v>..>v>..>>v..v>v.>..>.v.>>>.v.vv...vv.vv...v>.>v>....v>..v.v...>.>v.....vv>.v.>...>>>>>.>>.v.>......v..>..v.>>>>..>v>.vv
...>.v.vv...v...v.v>v>>.v.>>..>.....v.>.v.v...>.v.v.v...>>.>>.v>v...v>v....vv>>vv>...>....>.v.vvvv....v.v>>..v>v>.v>..v.>.v..v>>vv>..>>....
.vv.>>.>vv...vv.>>..v.vv.>v.v.>>>.>.vv>>.>.v>.>.v...v..v..v>v>.v.v>>..>v..>>..v...v>vv..>..>vv.vvvv>v.v>>.v>>>v.....>v.v>.>>.>>v.>>.>..>>v.
.......v..>..v>...vv.>>v>..>..>.>..v>.>>>vvv.v..v.vv>..v>.vv>v.v.>.>vv.vv>.vv.v>.v..>.....v>..v..vv>.>.>...>>v.>>v.>.>v.v>>>>...>.v>v>>v.>>
>...>>>v..>..>>....>.>>>v.....>>v.v...v.....v>.>.>..vv.....>...>v..v.....v.>v>v..v>..v>v.>v.....>..>.>.>>v.>.v..>.v>>vvv...v>>>>>vv.v>..>v>
....>..>.v>v.v.>..v>.v>>..v.v>>vvv>>.>v.>>...v...v>v>>.v>.>.>.....v.v>.v....v>>>..vv..v>>>>>..>.v.v.>v.v..>v>>>...>>v.....>v>>>.v>>.v..>.>v
vvv.......v..>..vv.......v>>v...>.>>..>.v....v.>>...>>...v...>.v.>.v>v.>.vvvv..v.vv...v....v.v>>.>..>...>...v>>>..v.>.....v.>v.>v..>v...>..
......>>>>.>vvv.>.......v>>v>v...vv...vv...v>...>.v.v..vv>.v>>..v.vv>v..v>.v>vvv>vv.>vv>>>...>.>.v...v..>>>...v..vv.>.vvv.>>>vvv.vv.v>v.v>v
>.>v>>>v...vv.v>..vv>...vvv....v..v..vvv>.v.>.vv..>...>>>.>>v>..v>>>.vv>..vvv.vvv.>>v.>.>>v>..vvv>.>>v.....v..>.>..>...v>.v.v.v.>.v>.v>.>.v
>.>v..v.v>vvv.>.vvvv>...>....vvvv..>...v.....v>v.>>..>.>..>v>.>>.v>>.v....>v>..>>v..v>.>>v>..v.>vvv>vv.>...>v.>>..>..>.....>>...v...v.v>.>>
.>.v..>>..v.>>vv..v..>>>>....>>.v>....>.v.....v....>v..>..>>.v.>..v.....v..v>v..vvv>v..>..v.>v.>v>.>vv.v..v....>.vv>.>>.vv>.>vvv>.v.v>..v.>
>>v>>......>.>>>>..>..>......>vv...>>v.>.....>.v.v>v>v..vvv.>>v.v.>v.>..>.>.>>.>v..vv...>v.>..vvv>.>..>v>>...>..v.v..v>..v>.v.vv>v.v>v>vv>>
.....>>v.v..v..v.....v>.v..>>....>...v>v.>...>..v....>...>..>.>..v..>v.......v.vv>.....vvv.>vv..>...v..>..>.>>.>v..>vvv...v..v.vv..>>v.>v>.
>..v>>>....v.v>..>>.>v.>..>..>v.v.>.vv..>.v.v....>..v..>...>.v>>..>>>...v..v>v>.>vv...vv.vv>..>>vv..>>.>v>.v.>vv.>v>..>v>..>.v..v.........v
v.vvv>v.>...vvvv.>>.>...>v>........v...v.v.>>v.vv.>vv>v...vvvv>.v...>.>v...v>.>>.>>.>v>v.......v.vv>v>.v..v>..vv>..v..>>..>v>.v>.>v>.>v>.v>
......v.>v>>v>v..v.v.v..>v.....>>.vvv>>.........>.v>v>>.v>v.v>>..v>>.v.vv.>.>vv>>.>....v..>.v....>.>v.v.v..>>..v....v..>>>vv.v..>.>.>>...v>
vv..v>..>v>>vv.......>>..v....>v...>>vv.>.v>..>v...>v.......vv........>>>vv>>...>v.>v.>>...>>v....v.>>.v.vvv>>v..>.v>>..vv>>>.>..v>...vv.v.
vvvv>..v..>.......>..v.>>v>...v>..>.....v>>>>..>..v.v...>.>..v.v.vv.>......v.>.v.v...>..>>vv..>..v>v......>v.vv..v>>..v...v..>..vv>.>...>..
..v.v>v.vv>vv.>....vvv>..>>.v.v..v.....>>.>.v>>..>.v...>>>>.vv.....vv....>.....>>..v..>..v..v>v>>.v>>>v.v...v>>.....v>>.>.>....v.v.>..>>..>
>v.v>v.vv..v...vvvv.......>.v>>>v>..v.>.v.vv.vvv.v..>v.>.>.v.v...v.vv......v.v...>.v.>.>>..v..>vv.>....v.>>>v.>..v.>.>>.vvv.>v.....v..>>...
....v>..vv..>..v.>>v.>vv.>.>.>vv.>....>>v.>>v.>...vvvv.>...>>...v>.v.>...>v>...>.>.v>v..v.vvv>v.>v.......>.>>>.v>..>v>.v.>vv>..>>v...v>v.>.
v..>.>>v>.v>vvv....>.>.vv.....vv..v...v>.>>v..v..v>.....>>v.>....v>...>v..>>>..>>.>>...>vvv....v>v.v>>..>.v>.>.>>.vv.>.v.>.>..vv>..>.v...>>
..>..v>.v...>..v..v>v.>>.v>...>.vv.v.>>v.v...v..v..>v.vvv....v>>.v>...>>vvv...>vv.v..v.>v>>>v..>v..>...>>.>.>..>>vv.....>v.>..>.....v..>..>
.>...>>vv.v.v>.>v>>vv>v>>...>v>vv.>.v..vvv>.>.vv..>.v>..vv....v...>vv>v.>vvvv...vv....>...v.v...>..vv..v...v.>>v..>v..v>v.v>.>..vv....vvv..
v..vv>vv>.....>v.>>...v>>...>...>.>v......>.v.>v.>.vv..........v..v>..v.>...>>>.>v>....v..v.>>>..>>.>....>>>..>.v>..v..>>vv.vv..>v>v>.>>.v.
>.....>..v..>...vvv>.>v>..>>v.v.>>.v..v.>>.vv.v>..>>>>.>..>v.>v>..>v.vv>.v.>vvvvv>.>>.>.....>>..vv...v..vvvv.vv....v>...vv....>.v.v>v.>vv..
vv>.>v.>........>>..v.>v..v....>>>v.....v>v..v>v.v>vv....v.v.>.>v>...>>.v>>..>.>.>..>>>>>>...>...>>v>vv..>>...vv>v..>v.......vvvv..>...v...
v.vv.....>v...vv....>v.>>..>.>v.>>vv.v..v.v.....v...v.>....v.v....>.vv...>>>.>>......v>.vv.>.v>>>.>.>..>..>.>..>.>>.>v.>vv........>vv...>v.
.v..>vv>>v....v..>>.>>>v....>>>>>vvvvvvv.>...>>..>vv..>v..vv>>..v>.>.>>..v>v>.v...>.>>....>>...v..v..v..vv>vvv.vv>vv..>....v.......v>.....>
.v>>v...>>.v......>....vv.v..vv.v>.>.vv.>>...>..>.v.>.>>v.>v..>..v..vvv.>.vv....>vv...>.>.....>>.>.v>.>v..>vv.v...v.v>>>...vv..v.v.v....>v>
v..v>>>..>>vv>v..vv>.....vv.vv.v..v.>>.>vv>.vv.v.>...>..>>.vv>..v.>vv....vv.>.v>>v.vv....>>..>v...v>.>.>v.......vv....v..vv...v...>>vv>.v..
vv...>>.>>..v>>...>.....vvv>....v>>v>v>vv.>.>.vv.v.>.>v>.>v....v.v...>>.>..vv>v.>..>>>v.v>..>>v.v..v>.v>>...v.....>>..vv>>>..>.>.>>..v>v..v
>v..>.vvv>.v..>v..v.v.v..>>...v..v>>vv>>...v..v.....v.v>v....v>.>.vv..vv..v..v.v...>>>vvvvv...>..>>v>v.>...v.>>.v.>.>..>>>>.>.vv.>..v......
...v.v.v..>...v...v...>>v>.....>.......vv>...>.>.v>v.....vv.>..>.....>....v..v.....>...>v.>..v>v.>.vvv.>v.>.>....>.vv>.>>.>....>v..v.>v>vv.
....>..vvvv..>v.>v>v.......vv.vv..>.v>v.vv.>.v>>.v..>.vv>>.>v.>>....>v.v.v.>...v..>>v>..>.v.>.vv...>>>vvv..vvv>..>>...........v.v..>v>.v>..
>..>v.>>...v..v>v.>.>>.>..v>v>>.>.>....>.>.>>v.>.>>v.>v.>>..>>>.>.>>..vvv.>v.v>>>>>..>...v>>v...>.>..>.>..>.>vv.v..>v.v..>..>>..v>>v.v..>..
vv.vv..v..v...v....>..>vv..vv>....>vv>.>v.v...v>.>>v>v.......>....v.v...v>..>.v>..vv..>>..v.>...>....>..v....>v>...>>.>v>.v>v.v>.......>>..
.v.>>.....>.>>.v>v.>v>vv>...>........>vv>v..>.v..>v..>...vvv....>>v..vv>v.>....v.>>.>.>.>>.v.v>..>vv>>>.>v.>>>v>>v.>..>...v>.v.>.v>>.v>v..>
>..>.v.vv.v.>vvv>.vv.v.v>...vv>.....v..>..v.vv...v.>>>....v>>..v>.v>v..>>.v.v...v.>.v>.v>.>>v..>.>.>...>>v.....vv..>v....>v.v>.v......>v..v
v.>v...>>.>...>.>v.>>v.>>vv>..vv...v.v.>.v.v>v..v.v.v.v.>....>...vvv.>vv...>.>v>.....v>.v.vv>.>>vv..v.v...vv...vv.....>..>v.>.>..>.>..v>.vv
>>.v>.>>v.....v...>>...v..v>>........>.vv.......>vv..>.v.v>.....>v.>..v....>.>v......v>....>v..v..>>..v>.......>.v..>>.>...v>.vv>.v.>>....v
....v>.v>...v.v>.v.>>v.v.>v.vvv>.vv...>>..>.>.v>.>>....>>>v.vv>vvv.>v>>.vv.>v..v>.vv>..>>.v>.v...>v..v.>...vv......v.v.>>..v>...>.>..>vv..v
.vv>vv.v..vv........>...>.>>.>>>v.vv.>v.v.>....v...v>..>>>v...vvvv...vv..v.v>v....>.>.v..>...v.>>...v....v..>v.>vv..v...v...v.>>.>..>.v.vvv
.vv>vv..v..v.vvv.>>..v..vv.v>>vv....vv>>.v.>v....v.>v>.....vvv.v...>...v..>.>.vv>.>>.>v>>..>....v...>.v>vv....v.>v>.>>v......vv>v.v>..v.>..
.v..v.v>vvv>.>.v...v>....>>>>..v.vv>.>.>...v>>>>..vvv.v.>.v...>..v>..>v.>.v.>>.vvv.>.>.>..>>>>....>....>..>..vv.>.v>>v>vv.v.>>...v.v>>v...v
...v.vv..>>vv..v...v.vv.vv.v.v...v....>....v.v...v.....vv...vv>....>.>...>..>.>..v.....>>>......vv>>.v....v...v>.....vvvv..v>>.......>>v>vv
...>>.>>>v..v...>....>....>.>..v>v....>v.>v..>.>>>v.v....vvvv.>......>v..vvv>.>>..v.vv...v>.>v>>vv.v..v>.v.....v>.v....>.>..>>...>vv>.>.vvv
.>vv...v>>v..vv....v..>vv.>v....v...>>..>.v...v..v..vv....>..>...vv.>v..>>v...v..>v.v>...v>v>>.vv.>>....v>>vv>v>v.>.>>....>..vv..>..>>>>>v.
v....>>>.vv..vv>>v>...v>.....>>v.>.>.>.v..v>v>.>v.v.vv...v..v....v>>.v......>..>..>.v.v..vv.v...>vv.>...>..v.>.v.......v>v>.>>>vvv..>>..>>.
v>vv.>..>>...>.v>v>....>.>..vv.v>>...>>>..v..vv>v>>>...>v.>..v>...>.vv>v.>>v.v..>>>v>v>v..v.>..v..>>.v.>.v.>.>>..vv.>>>>>>.>..v>.>v.>.v>>>v
v.>>>v.v.>v>v>..v>>..........v.vv>.v>>v.vvvv.>...>v>.v..>>v.vv..v........>v.>v.v.....>.v..vv>>.vv.>v.vv>.>vvv.vv..>>vv.>>>....>v...v.>>>>>v
>.>.v..v..>......>..>>>v.vv..>>>v>.v>>v>>>>.v..v..>>v>vv.>..v.>>v..vv.vvv..>.v...v....>.>v..v...v.v.v..v.vv>vv.v....>.v.v.>>.v....>....>.>v
v......>.>..v.v..>>..>v.vv>.>..v..v.vvv.>......vv>..v....>.>v.v.v.>..vv>>v.v..>.>>...>.vvv>>>>vv..v.>vv.vvvv.v.vv>.>vv.>>.>v.v....>>>..>...
.v.v..>....v>.>v.v.vv.v.>.>.v>...>...>.v..>v.>.>vv>.>>...>.>v>v..>>>>.v.>vvvv...v>>....v..>..v>...>...>.>>>....v>...vv..>..>>>..v>...>..>>>
..vv>..v.v.v.>.>>.>v>vv..v.v.vv>.vvv.....v.>>.v..v>vv.vvv.v.v.>..v>...>.>v.>v.vvv..>v.....>vv>v.>.....v>.>vv..>v.vv.vv..v.>v.vv..v>.>..v.>.
.v........v.vv.v.vv.>>v.>v>>vvvv>..v>>.>v>..>...vv>>v.vv..>.>v.v>..v..v.>.>..>v>>..v....v>>>>.>v>....>>v.vvv..>...v>>vv.>..vvv..vv..>.>..>.
...>>v>>.v>>..>vvv..v>...>..v.v>....v..v>.vv>.v..>..>v.>..v.>..v>.v..>vv.>>.>.>vv.v>>>>>v..>v...v.....v>>..>v.v>..>...v>vvv>v..>>>>.....v..
>...>v.>vv...>.........>>>..vv...>.>>...v>...>v>..>>>...>v.>.....>v>>.....vv.v..v>..>>v.vv.v.vv.v..vvvv.>.>.>......>.....v>.>v>.v...>v..vv.
..v.v>.>.>>.v>....vv>...>.>>>..>>v>>.vv>..>.v>.>..>.>.v>v......>.v>>...>......>.v.v.......>.>.v>>>>..vv>>...v>vv>.>......v...>...v.v>..v..v
>>.....v>..>..v.>...>.vvv>vvvv.vv.>v.>.......v.>.>.v.......>...>>>>.v>>.v...vv>.vvv.v..>.v.v...>.v.vvvv...vv.v..>>..v..>vvv.v.>..>.>..v>>>>
v..vv.>v>...v>.v.>.>>..v>.>.>.>>v>>v....vv.v...v..vvv.vv>v...>>..v..v..>..>..>v..vv....>>>>.>v..v...v..>>.>..>.v..>v>>v..vvv>>...v>v..>>v..
>vv.....v>..v>v....v......>.>>.v>v.>v>.>.vv>v>>>.>vv>.>.v>v.v.>v..v....v>v.>.>....v>>>.>....v..>v....>>>v.v.....>.>..v.v.>.>>>vv....v.>..vv
.v.>.v...>..v..v>.v>..>v......>vv.v...v>vv....>.v>>>.>vvv..v.v.>.>.>v>.v.v...v>...v>..v..>>.v.>..>v.v>>v..vv.vvv>>v>v>v>.>.....>.>>..>.v.>.
.>>.>>v>vv.>>..>v..>v.vvv.v.>..>.>..>.>..v..>.v>v>.>v.>.v...vv..>.v>....v.v..>.>....v>v.>.vv>vv...v.v>.>..>>.>>...>vv.>.v.v.>..v...>>v.vv>.
>>.>v...>..>...v....vv..........v..v.v.>v>>v>...v.vv.v.v....vv..v>.v...>.v>.vv...>v....>>.vv.........vv.>..vvv..vv.vvv..>>..>v.>vvv..>.v..>
..>v.>..vv..v>>>>>...>>v.v.v..v>>v>..v....>>.v>..vv....>>v.>>vv.v..>..v.v>v....v.>.....>>....>v..>.v..>.>v.vv....v...v.vv>.v>.>...v>.v.>v>.
>.v....>.>.>..v.vv...v>>v...v..v..>>.>......>v..v.>v.>>.v..>v>>..>...>.>v.>..>>.v>vv>...>....>..v..v.vv.vvvvv..v.>vvv>v.>...v>>v>v.>>...>.v
>.v..>..>..v.v.v>v.vv..v.v....vvv>v>>..>....v.v>>..v>....>.>v.>.v....>.>.vv.>...vv>>vv...v...>.v..v>.v...>v>vv>v>..>>.v>.>.>.v>.v>vv..>v>>.
.vv>..v>>v...>.>vvv.v.>.v..>>>>.>v>v>..vvv.>.v>.>...v....v..vv>>..>.>..>.>v.>.>v>vv.>>>vv.>....v.v.vv>v...v..>........v...v>.>vvvv.....v...
.>.v.>....>..>.>........v>.v>>v..>.v.>v.v..v>...v.v..v>vv.v..v>v>.....>>v.......v>v>v.v.>.....vv..vv...>v..>>>.>..v>vv.>v...>.>..v>vv.>>v..
.vv.>...v.>...>..>....v...>>>.......>>......>vvv..v.v..>v..>.>>.>.v...v...>..>>..>v..vv...>..vv........>>..>...vv>.>.v.v.v.v...v.v.>.v.....
.vv..........>v>..v.>.....v.>.v..>v....>..v..v>>..>.>.v....>..>>.vv>.vv.v.v.>.v..>>..vv..>.vv>..>.>>.>......v.>..>>>vv>>.>.v.vv>...>>v.v...
.v>vv.v.vv......>vv.v>.>.>>v>v....>>v...>.v..>..vv>>.v.....>>>..v..>v.v.>.v>>>.vvv.>.>..v.v..>.>...>.>>vv.>.>v.....v.vv.vvv>...v..v>vvvvv..
vvv..v>..>...>>>v>v..v........>...>.>v>>>v>>>>.>>.>.....>>.>v>.>v..>....>>.>..v>v>>.>v...vv..>v.>>v>..v.>v.v.>.....v.>vv.vvv>.vv>>..v.v..>>
v>......>>v>>.>.>..>..>.>.>v>>>v>..>>>>>vv..>v>....v...v......>vvv>.>....vv>>>..vv.>...v>>v....>>......>..v.v>v.>>.....>..v.>.v..>v.vvvvv..
.>>v>v...v....v.v.>>.>.vv...vvv.>>..vv..>...v..v>............>.>>.v>v.>.vv.>...>.....v.v...vv.v.v...v>v>v.v>.>v>v>>v>..>.>v....v.>..>v.v...
...v.v....>...v.>.....vv..>..v..>>.>.>.....v.v.v>.>.vv.>...v..>......v>..vv.vv.>.>v..>.>.>v>.v.>.>.>.....>..>v...>.v>v..>....v.>.v>..v.>>..
v>vvv>>..v.>>>.>>..v>.v>.v....v.v....v...vv.....vvv>.>........>>>..v>>vv...v..v.>>>.vv.v....vvvvv>..v..vvv>..>.>vvv.>....v..v.>v>.v.vv...>.
v>v..vv....>.>v.v.>..v..v.........>.v.v>.v.>.v.v.>vv.>>>v.>>.>.v..v....>vv>.>v.....>.>>...v>....v...>>v.vv.....v>v.vv.>..v>.v..>...v>vvv...
....v>>>>..vv>>v..vvvv.>..vv..v.>>.v>vvv>.vv..>....>.>.v...v>v>...>>>.v......>..........>>v.v..>v>vv...v...>.>>..v>v>.vv...v...>....>>>v..v
.......vv>v.>>v>v.>............>v>v>vvvv>>>...vv..>v.......>.vvv>.......v>.>vv..>>.>...v..........v...>v>v>>..v..v.v..>>>>..>..>.>>>.v....>
.>vvv>.....v...>v>v.v>...v..>vv...vv..v>vv...>.v.vv.v>.v..>v..v..>vv.>...v.v>v.vv.>v>>>....v>.>v..>..v.>>vvv>..vv...>...vv.v..vvv>...v.v.>v
..v>.v.v.>>>...>.>v.vvv...>>v.....>.>.>v.>v.>...>v>vv>>.v>>.>....>>v..vvv..>.v.vv..>>>.vv..v.>.>..>.......>>..v.v>v>v.vv....>vvvvvv..>>>>vv
...v.>.v.vv..>vv...>v...>>.vvvvv.vv.>v.>>..v.>>..>>.......>.v......v>v>>.>v>.>....v....>..>v.v>.>.>>v.>v..>..>.vvv.>.vv>..v>>.....v.>.v..>>
....vv.vv.>.v>v........vv.>>v>....v.>>..>..v>.>v.....v...vv..v>.......v.....v>>>.>.v>.v..>.v....>.v>v>.....v>>v.>..>.vv>vv>v.>>....v>.>..v.
v.>>>>v>.....>.>v.>.>vv..>v.vv..v.>.>v>vv.vv>..>.>....>..v>....>.>>v.v..>.>>v>........>.vv>>vv........>v.v>.>..v...v....v..>v>>.v>>.v...v>.
...v.>>.>.v>...>.....>v>...>>.......>>>.v.vv>...>...>v>v>.>.....v.>..>>vv..>vvvv.>...>..v>.v..vv..>>..>.>.>.vv..>vvv..>.>>..v...>.....v.>.>
v>.v>..v.v...>.v..v..>.>>.>v>vv.>.vvv.....>v>.vv....vv...v>v>>>.>>v.v....v.....v.v..v...vv>v..v....vv.>v..>>v....>v..>v>v.>vv..>v..v>v.v>>.
v......v..v...v..>.v>..........>.vv...v.>v.>..>v..v.v.>.vv.>...>>....v>v>>.>>.>v..vv.v......>.>>.vv.....>>v>vv..>..>v>...vv>....v>.>.>.>.v.
.v>>>..v>.>.....>.>.v.>v>>..>v.>.....>.>.>.vv..v>.v....v>>v..v.v...vv>...>v..v.>v......v..v.>>..>.>v..>v.v>vv>v...v>.>>.v>vv>..v..v..v>>...
....>v..vv..>>>v.v>....>v...>vv>.>.>.....v....vv>.>vvv.>.>v>>v.>.v.>>..>..>>vv..v>.v>>.....>>.v>v.v>.v..>.vv.>vv>>.v..>.....>>..vv>>....>v.
v...v..vv..>v.v..v....v.v.v>>..>v.v.v...>>>v>.>vv.v>....>v>.v...v......v..>vv>.v...>.>v..v>v>...vv.>>>....>>>v.v>>>v.v>vv.vv.....>>.v...>.v
>.v...vv>v....>v.>.>>.v.>.>v.vv>>>>>vv>v..>.v>>v>...v>v.v.....v....v..>...>.>..>vv>..v.>v...v..v..>>.v>>>...>v.v>>..v>....>>.>v>..v.v>>.>>.
..v>.v.v>vv.>>.>vvvv..v>.v..>.>.>>>>>vvvvv..>..>.>.>...vv.....>...>...v>.vv>>..>vv..v.>..v..>....v.v...vv.>..>>.>>>..v.>>.v.v>>.>.>..>>v...
v.>.v>v>....>vvv>>>.vv.v.v.>>...>v.v>..>..vv..>.>>>....>.v>.>>vv.>>>v..v>v..vv.>>.v>>.>>vv.v>v.>.v>.v>..>.v...>>>....>vv..>.>>v.v>..v.v.v>v
v.>v..>.v..>v..v>vvv>vvvv....>v.v..v..v>.>>>.v..>...v.....>..>v>.>..v....>..>.>.v>.......v...>....>.>.v>.vv.v>.....>>.....>.>>>.>.>v>vv.>>.
..>>.v.v.>..v..v>.>>....>v.v>...v.>.v.>..v.v..>.......>..v>.>.v.>...vv>v>v>..v.>.....>v..>..vv...>v...v.....>.>..v..v.>v>.v.v.vv.vv>v..>>.>
..v....>v..v.v..>...>.v>.vv>v>v>vvv..>..>vvv..v>...vv.>v>>...>.v...vvv.>>.v...v>.>........v>..>.>.v..v>....>>.>.>...v.v..>>>>v>vv...v...>>v
......v>........>vv>>....vv.>.......vv......v>vv.v..>..v.>v...v..vv.>......v...>..>.>>vvvv.v...>.v....v....v>.v.....v.>>v>..v.v>>>..v.>v...
..>v>.>>>.v.v>>>>>>v......vv....vv>v>v..v.v.......>.vv.>.v>..>.............vv.>v>..>v.....>>vvv.v>vv.......v..v.v.v..v>v.>.>v..>>.>>v.vv.v>
v.>.v..>>..>>v..v>.>.>>.v.>>v>.>>..v>.v.vvv.v>.vvvv.>>v.vvv...v..v.>v....v>.v>v........>v>>.vv.v.>..>..>v.>..>..>.>>>>>..v..>.v....>...>..>
..vvv>..v..>v>>...v.v...>v.>.>v.v.....v..>.>v>v.v.>..vv.vv>>.>v.v>v.>..v>v>..v>v.>.>>v>...>v>>>.>..>.>>v>v...vv.>v>>>..>.v>...>v>.v.>>.>vv.
v>v....v...v.>vv.>>>.>>>.>vvv..v.v.vv......v.v...>v..>.v>>>...>.....>....>.v>...vv.....>...v.>....>v.vv...>..v..>...>..vvv>.>>>..v>.>>>>>..
v..v>.vv.>.v...v.>v.vvv....v>v>>>.v.vv..v....>v..v.v>.>v.>>v..>....vv......>vv.vvv..>v>v.>v.v>v.v.>v.v.....v>.>...>>.>v>..>.v>v.>..>.v.v..v
.>>.v...v.v>..v>.v.>v....>..>.v.v..>...>v>..>.>..v........v>.v>vvv.vv..>v>.....>..v..v.>v.v....>v.v.>>.>.vvv.vv.>.vvv>.v>...>v.>v>..vv.>...
v>.v..>.>vv.>v>...>..vvv.>>.v>>vvvv.v.>.vv>.v..v.>v.v.>...v>v..v.v>vv.v>>.>.>......>.>>>v>v>.........vv>vv.>>vvv...>>v>.>.>>...>v....>...v.
...v...>v>v.v>>v>vvv...v>>...vvvv>..v.>>v..>.v>..>v>v..>..v.v>.>..vv>..>.vv....v>v>>>v>.v.v.v>.vv.....>>....>..>>.>v.>v>v.>.>>...>vv.v..v..
...>.v>...>...>vv...vv>..vv.>.vv...v>vv>vv..v>v>>v>>>>.v>v.>v....vvv.vv....>>v>...v..vvv..>....v.v.>>.v.>>..vv.....v>>v>.v...vvv>.....>v..v
.>.>>v.v.v>....vv.>>.>v.>.....v...>vv..>>.>..>v.>...vv..>.>>.v>>......v>.>.v>>...>.v.v>>..v.vv.vv....>.vv>>>v.>......>>.>.v>vv>...vv>>>>.vv
.vv..vv...v>v..v.v..vv.>..vvv.vvv...>.>>v>>vv.v>..>...v>...vvv.>.>.>.>>>>>.>.>.v..v.v.....v..>>>>v......vv.v...vvv........>.vv..>>>..v>..>.
....v.>v.v>.v.>....v>>v>.v..>.>.v>..>v..v.v>.....v.vv..>.>v>...vv>>...v>.....vv>...>>>......>>v.>>.>.>...>v.>....v>..>.>>....v>vvvv.>.>.>..
>v.....>>.v.vv.v.>>v>v>.vv>>v>vv...>.>.vv>..vvvvv>>...v>>v.v..v..>.>.>>.v..>.....v>v.v..>>v>v.v>.>...v>.v...>>...vv.v>vv...>>>......>>...v.
...>...>.v.>>v..>....>v.v.>>..v..vv..>.v>.v.v.>.v>>..v>>.>.v.>vv>..>........v>...>>.>>>>v.>v.v..v.v>.>>>v.>>..v....v.v..>.>>v>.>.>...v>.>>.
>.v.>...>>..>v>>v.vvv>..v.v.v.....v.>...>vv.>.>vv.v.....>>>vv....>v>v>v.v>.v>v.v>..>>...v..>v>.v.vv>.v.v.vv...v.v>v.vvvv..>vvv>.>.vv.>v...>
v.>v......v.v.v....>..v.v>>..v...>...>>v..vv.>.vv>>v>>vvvv>>.v..v.v.v.v....>v>..vv.>...v..>>>v>..v.>.>v..>.v.>>..v.vvv.v...v>...>...>>..v..
.>v>.>.....>>...v.>.>.vv..v>>.v..>.v..>vv..v..>v>>..>vv..>v.>.>....v...v..>v..>.>>>vv.....vv...>.v>.>.....v>...>>..v.v.>..vv.v...>>...v.>.>
...>>..v..>..vv.>.>>v>..>..>.....>.v>v..v.>>>..v..v>.>>...>>..v>v.>>.>..v..v.v.v>vv>.v...v>.v..v>.>.>..>.>.>.>....v...v>...>..>v.>....>.>v.
v..v.v.vv.>...>v..>..v.......vv>.>>.>.v>.......>..v.>v.v>>.vvv...>>.>..>..>>.>..>v>....vv..v..v>v.>vvv..v.v.>....v..>v.......v......v>v..v>
v>.v....>v..>.>v>v..v..>v.vv.>v.v.>.v..>v.>vv>>..>v>..v>v..v.>..vv..>vv>.v.......>..v.v>>v.v.....>>vv....v..>.v...v.v>..>.>.....>v....v...v
..>.v....>>.>..>.>>v.>.v..>v...v>.>..>.vv>.>vv>v>.>>v>..>.v.>.>..........>.>vvv...v..v.v.>>.>>>....v>..>.vv...v...v.vv>v.>v>..vv..>>>>>vvv.
...v.>.>v>.>>...>v.>>v.......>.>>v>v...v>vv....v.>....>.>..v.vvv.>..>.vvvv.v.v.>>.>.vvvvv..v...vvv.v.>>v>.v>>v.>v..v.>v>v..vv>...v>.v.v...>
v.v....>v>..>>.>>....vv...>..v..>>..>.....v>.>v>..>....>>>vv>>.vv...v....>..vv.v>>..>.v.>.v>.v>>.....>v....vv>..>..vv.>.v.v>..vv..>v>.v.>>.
.v.vv>....vv.>v>v.>.v.>>v.>>v>.v>..v.......>..>>>vv.vv....>>....>v.vv.v..vv..>.>..v......v.v>>v>v>..vv.v.vv.v.v.>>v.>.v..>...vv>......vv>.v
.vv>..v...vv>>v>....vvv..>v>..>..v.....vv....>..>v.v..v>.>>.v>v..>.v>v.vvv.v.>>..>......>v.v..vv.>..vv>>.vvv>v>.v>.>.........>v..vv>>..vvv.
.v.>v.vv.vv.vv.>>>vvv.v..v..>>v>.vv..v>.v>.....v>v..>v>>>>v>..vv..v...v>..>.v..>...v..vvv...>..v.>>..v.v...>.v>vvv..>.v.>>..vv>>v..v.vv.>.v
>>...v.>.>..>v>.>>.>v.vv>....v.>v.>>>.vv.>>.v.v...v>.v>>.v...>vv>>vvvv.>...>v>..>...>.>v..>.v..vv>....>>.vv>..>.v.....>v.v..>.>.>.>..v>..v.
.v>>.v........>v>vvv.>>.>vvv>>v.>.v>..>....v>vv...>.>v>.>>>>v.>>....vv>v.vv>.v........>.v>.....v..>>v.v.........>v>.>>.vv.>>.v...vvv>v.>.v.
>..>..>..vv.>>>>v...>>>vvv.>>.>v>..>...v..v..>>>v...>>.>.v...>.>...>...v>>vv.v.....>.v>v.vv>v..v.v.v>..>..v.>>.v.>v>>.v.v>....v.>..>v>vv...
...>>..>>vv..v>v>>vv..>vv..v>....vv...>v..>v...vv.v....>>>......v>v>>..v..>..v>>.>vv>v..>..>v..v>>v>...v>.>...>.v>..>.vv>v>....vvvv.v..vv..
.....v>v>>>v.v..v>v.>.v.>>>.>.>>>..v.>.v.v>vv>..>.vv.v>...vv..v.>v....v..>vv.>.vv>v.>>>v>v....>v>>v...>v.>v..vv..v>.>v..>.v.v.>..>......v..
>>....v>v>v..>>v......v.>...vvvv.v.....v..v.>>.>.vv.>>>..v>.>v>v>>........>vv.>v..v..>.>v.>>...v>>.v>v..>.v..>>.v>..>>>.v.>.v.v>.v.vvvvv...
v>...v>..vv.>v..v....>..>.>>.>>.vv..>>>.>>..v.>v.vv...>>v.v.>.v..v.>...>>...vv..>v.v.>...>>...>>.vvv...v...>v>....vv....>...>..v.v..>>.v>v.",
                0);
        }
    }
}